// pages/clubhome/clubhome.js
const App = getApp();
Page({
  data: {
    item3: [
      {
        img: '',
        name: '潍坊市马拉松运动协会2017黄河口东营-国际马拉松赛报名啊啊啊啊啊啊啊啊啊啊啊啊',
        time: '2017.12.21 17:30',
        club_name: '报名数',
        money: '￥230.00'
      }
    ]
  },

  onLoad(params) {
    this.getClubIndex(this);
    this.getMamberActivity(this);
  },

  /**
   * 获取俱乐部主页
   */
  getClubIndex: obj => {
    let param = {}
    let data = {
      club_no: 30328
    }
    param.data = data;
    App.clubApi.clubIndex(param, res => {
      obj.setData({
        club: res.data.club
      })
    });
  },

  /**
   * 获取用户活动信息
   */
  getMamberActivity: (obj) => {
    let param = {}
    let data = {
      user_id: 14389,
      start: 0,
      count: 30,
      exceptProxyAct: 0
    }
    param.data = data;
    App.clubApi.clubActs(param, res => {
      let data = res.data;
      if (data) {
        let activities = data.activities;
        activities.forEach(e=>{
        e.begin = App.util.formatMonthDay(e.begin);
        })
        obj.setData({
          activity: activities
        })
      }
    })

  },

  natoChargeActivity: function (e) {
    App.wxService.navigateTo('./clubhome')
  }
})