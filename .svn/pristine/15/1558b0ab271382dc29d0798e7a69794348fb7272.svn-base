var app = getApp()
const actApi = app.api("actApi")

Page({
  data: {
    acts: [
      // UI调试数据
      //   {
      //   begin: 1487293200000,
      //   freeSmsCount: 1,
      //   activityStatus: 0,
      //   applyUnReadCount: 3,
      //   shareCount: 0,
      //   applyCount: 3,
      //   time: '12-23 23:06',
      //   readCount: 7,
      //   timeFlag: 1,
      //   freeSmsCount: 12,
      //   userName: null,
      //   title: "你名字",
      //   cover: "https://cdn.51julebu.com/club/img/170210/48947d8d868b4419a96ca479497acad2.wj",
      //   groupNum: 0,
      //   activityID: 591714,
      // }
    ]
  },

  onLoad() {
    let that = this
    actApi.manageActs({
      data: {
        user_id: app.session.getUserInfo().userID,
        exceptProxyAct: 1
      }
    }, (res) => {
      //成功回调
      let activities = res.data.activities
      activities.forEach(e => {
        e.time = app.util.formatTime2(e.begin)
        e.timeFlag = e.activityStatus == 0
      })
      that.setData({
        acts: activities
      })
    })
  },

  selectAct: function (e) {
    let activityId = e.currentTarget.dataset.id
    app.wxService.navigateTo('index/group_page/group_page', {
      activityId: activityId,
      delta: 1
    })
  }
})