<scroll-view style="height:100vh;padding-bottom:100rpx;" scroll-y="true">

  <!--搜索框-->

  <!--<view class="search_view">
  <input type="text" maxlength="16" placeholder="{{search_text}}" placeholder-class="psection" />
</view>-->

  <!--topviews-->
  <view class="top_view">
    <view class="top_item_view">
      <text class="mid_text">共{{allApplyCount}}人报名</text>
      <view class="top_item_foot_view">
        <button class="button" wx:if="{{howToPay > 1 && tickets.length > 0}}" bindtap="tapChargeButton">按费用查看</button>
      </view>
    </view>

    <!--服务器下发的组-->
    <view wx:for="{{groups}}" for-index="index" id="{{index}}" class="top_item_view" style="border-bottom: 1rpx solid rgb(230, 230, 230);" bindtap="tapDidGrouped">
      <text class="big_text">{{item.groupName}}</text>
      <view class="top_item_foot_view">
        <text class="small_text" style="margin-right: 25rpx;">{{item.applys.length}}人</text>
        <image class="icon_image" src="{{icon_img}}"></image>
      </view>
    </view>
  </view>

  <!--通过处理applys得到的组-->
  <block wx:for="{{resultArray}}" wx:for-index="indexX" wx:for-item="group">
    <view  class="mid_item_view">
      <view class="mid_item_mid_view" id="{{indexX}}" bindtap="tapOpenOrCloseGroup">
        <view class="icon_view" id="{{indexX}}" bindtap="tapOpenOrCloseGroup">
          <view class="{{group.open ? 'css_icon_true':'css_icon_false'}}" style="{{group.open ? 'margin-left:30rpx':'margin-left:35rpx'}}" ></view>
        </view>
        <view class="text_groud_view" id="{{indexX}}" bindtap="tapOpenOrCloseGroup">
          <text class="mid_text" style="margin-left:22rpx;" >{{group.text}}</text>
          <text class="small_text" style="margin-left:9rpx;"  >{{group.count}}人</text>
        </view>
      </view>
      <view class="top_item_foot_view">
        <button wx:if="{{group.button_text!=null && item.button_text!=''}}" id="{{indexX}}" catchtap="tapForGroupButton" class="button">{{group.button_text}}</button>
      </view>
    </view>

    <!--未点击的列-->
    <block wx:if="{{group.open}}" wx:for-index="indexY" wx:for="{{group.applys}}" wx:for-item="obj">
      <view wx:if="{{!obj.open}}" bindtap="tapRowForDisplay" data-x="{{indexX}}" data-y="{{indexY}}" class="list_view1">
        <view class="image_view">
          <image class="user_image" src="{{obj.user.userImg}}"></image>
        </view>
        <view class="user_info_top">
          <view class="user_info_name_top">
            <text style="font-size: 32rpx;">{{obj.user.nick}}</text>
            <text class="small_text" wx:if="{{obj.isManagerHelp}}">{{obj.helper.nick}}帮报</text>
          </view>
          <text wx:if="{{howToPay>1}}" style="font-size: 26rpx;margin-top: 11rpx;">{{obj.ticketName}}￥{{obj.price}}</text>
        </view>
      </view>

      <!--点击后的列-->
      <view wx:if="{{obj.open}}" class="list_view2">
        <view bindtap="tapRowForDisplay" data-x="{{indexX}}" data-y="{{indexY}}" class="list_view2_top">
          <view class="image_view">
            <image class="user_image2" src="{{obj.user.userImg}}"></image>
          </view>
          <view class="user_info_top2">
            <view class="user_info_name_top">
              <text style="font-size: 32rpx;">{{obj.user.nick}}</text>
              <text class="small_text" wx:if="{{obj.isManagerHelp}}">{{obj.helper.nick}}帮报</text>
            </view>
            <text wx:if="{{howToPay>1}}" style="font-size: 26rpx;margin-top: 11rpx;">{{obj.ticketName}}￥{{obj.price}}</text>
            <text wx:if="{{howToPay>1}}" class="small_text" style="margin-top: 11rpx;">{{obj.payString}}</text>
            <text class="small_text" style="font-size: 26rpx;margin-top: 37rpx;">{{obj.baseString}}</text>

            <!--<text class="small_text" style="font-size: 26rpx;margin-top: 20rpx;">{{obj.people_id}}</text>-->
            <text class="small_text" style="white-space:normal;font-size: 26rpx;margin-top: 19rpx;">{{obj.fieldString}}</text>
          </view>
        </view>
        <view class="user_foot_view">
          <picker wx:if="{{group.text =='未分组' && groupNameArray.length > 0}}" data-x="{{indexX}}" data-y="{{indexY}}" bindchange="tapGroupPickerChanged" value="{{index}}" range="{{groupNameArray}}" class="foot_text">
            分组
          </picker>
          <text wx:else bindtap="tapApplySmallButton" data-x="{{indexX}}" data-y="{{indexY}}" data-tag="0" class="list_item_text" style="{{group.small_button_title=='审核' ? 'color: rgb(255, 126, 86);':''}}">{{group.small_button_title}}</text>
          <text bindtap="tapApplySmallButton" data-x="{{indexX}}" data-y="{{indexY}}" data-tag="1" class="list_item_text">编辑</text>
          <text bindtap="tapApplySmallButton" data-x="{{indexX}}" data-y="{{indexY}}" data-tag="2" class="list_item_text">电话</text>
        </view>
      </view>
    </block>
  </block>

  <!--灰条view-->

  <!--<view class="border_view"></view>-->
  <view class="apply-mangage-footer">
    <view class="foot_view">
      <text bindtap="tapSendMsg" class="list_item_text1">群发短信</text>
      <text bindtap="tapAddApply" class="list_item_text1">添加报名</text>
      <text bindtap="tapGetExcel" class="list_item_text1">导出表格</text>
    </view>
  </view>
</scroll-view>
<view class="phone" hidden="{{hiddenAlert}}" style="opacity:1;pointer-events:auto;">
  <view class="phone-dialog">
    <view class="phone-text">
      添加新分组
    </view>
    <view class="phone-box">
      <input class="phone-input" maxlength="100" type="number" focus="{{getFocus}}" bindinput="didInputChanged" value="{{phoneNum}}" placeholder="输入" placeholder-style="font-size:28rpx;letter-spacing:1rpx;"></input>
    </view>
    <view class="phone-button">
      <view class="phone-hehe">
        <button class="phone-btn phone-cancel" bindtap="tapCancelAlert">取消</button>
        <button class="phone-btn phone-canadd" bindtap="tapSureAlert">确定</button>
      </view>
    </view>
  </view>
</view>